<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Good Noodle Board ‚≠ê</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --pink: #ff6b9d;
            --pink-light: #ffa3c4;
            --purple: #c44cff;
            --purple-dark: #9b30cc;
            --gold: #ffd700;
            --gold-dark: #daa520;
            --cream: #fff8f0;
            --dark: #2d1f3d;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #1a1025 0%, #2d1f3d 50%, #1f1a2e 100%);
            min-height: 100vh;
            color: var(--cream);
            overflow-x: hidden;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            text-align: center;
            margin-bottom: 2rem;
        }

        h1 {
            font-family: 'Fredoka One', cursive;
            font-size: 3rem;
            background: linear-gradient(135deg, var(--gold) 0%, var(--pink) 50%, var(--purple) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 4px 30px rgba(255, 107, 157, 0.3);
            margin-bottom: 0.5rem;
        }

        .subtitle {
            font-size: 1.1rem;
            color: var(--pink-light);
            opacity: 0.8;
        }

        .mode-badge {
            display: inline-block;
            padding: 0.3rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 0.5rem;
        }

        .mode-badge.dom {
            background: linear-gradient(135deg, var(--purple) 0%, var(--pink) 100%);
            color: white;
        }

        .mode-badge.brat {
            background: linear-gradient(135deg, var(--pink) 0%, var(--gold) 100%);
            color: var(--dark);
        }

        .noodle-name-section {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .noodle-name {
            font-family: 'Fredoka One', cursive;
            font-size: 2rem;
            color: var(--pink);
            text-shadow: 0 0 20px rgba(255, 107, 157, 0.5);
        }

        .edit-name-btn {
            background: transparent;
            border: 2px solid var(--pink);
            color: var(--pink);
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .edit-name-btn:hover {
            background: var(--pink);
            color: var(--dark);
        }

        .board {
            background: linear-gradient(145deg, #3d2a54 0%, #2a1d3a 100%);
            border-radius: 20px;
            padding: 2rem;
            box-shadow: 
                0 20px 60px rgba(0, 0, 0, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border: 3px solid var(--purple-dark);
            position: relative;
            overflow: hidden;
        }

        .board::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.03) 0%, transparent 50%);
            animation: shimmer 10s linear infinite;
        }

        @keyframes shimmer {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .score-display {
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
            z-index: 1;
        }

        .score-label {
            font-size: 1rem;
            text-transform: uppercase;
            letter-spacing: 3px;
            color: var(--pink-light);
            margin-bottom: 0.5rem;
        }

        .score-number {
            font-family: 'Fredoka One', cursive;
            font-size: 5rem;
            color: var(--gold);
            text-shadow: 
                0 0 30px rgba(255, 215, 0, 0.5),
                0 4px 0 var(--gold-dark);
            transition: all 0.3s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }

        .score-number.bounce {
            animation: scoreBounce 0.5s ease;
        }

        @keyframes scoreBounce {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); }
        }

        .star-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(50px, 1fr));
            gap: 10px;
            margin-bottom: 2rem;
            min-height: 120px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 1rem;
            position: relative;
            z-index: 1;
        }

        .star {
            font-size: 2.5rem;
            animation: starAppear 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
            cursor: default;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.6);
            transition: transform 0.2s ease;
        }

        .star:hover {
            transform: scale(1.2) rotate(10deg);
        }

        @keyframes starAppear {
            0% { 
                opacity: 0; 
                transform: scale(0) rotate(-180deg); 
            }
            100% { 
                opacity: 1; 
                transform: scale(1) rotate(0deg); 
            }
        }

        .star.removing {
            animation: starRemove 0.4s ease forwards;
        }

        @keyframes starRemove {
            0% { 
                opacity: 1; 
                transform: scale(1); 
            }
            100% { 
                opacity: 0; 
                transform: scale(0) rotate(180deg); 
            }
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 1.5rem;
            flex-wrap: wrap;
            position: relative;
            z-index: 1;
        }

        .controls.hidden {
            display: none;
        }

        .btn {
            font-family: 'Fredoka One', cursive;
            font-size: 1.2rem;
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-add {
            background: linear-gradient(135deg, var(--gold) 0%, #ffaa00 100%);
            color: var(--dark);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.4);
        }

        .btn-add:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(255, 215, 0, 0.5);
        }

        .btn-remove {
            background: linear-gradient(135deg, var(--pink) 0%, var(--purple) 100%);
            color: white;
            box-shadow: 0 8px 25px rgba(255, 107, 157, 0.4);
        }

        .btn-remove:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(255, 107, 157, 0.5);
        }

        .btn-reset {
            background: transparent;
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
            padding: 0.8rem 1.5rem;
        }

        .btn-reset:hover {
            border-color: var(--pink);
            color: var(--pink);
        }

        .status-section {
            margin-top: 2rem;
            text-align: center;
            position: relative;
            z-index: 1;
        }

        .status-badge {
            display: inline-block;
            padding: 0.8rem 2rem;
            border-radius: 30px;
            font-family: 'Fredoka One', cursive;
            font-size: 1.3rem;
            transition: all 0.5s ease;
        }

        .status-good {
            background: linear-gradient(135deg, var(--gold) 0%, #ffaa00 100%);
            color: var(--dark);
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
        }

        .status-neutral {
            background: linear-gradient(135deg, var(--purple) 0%, var(--pink) 100%);
            color: white;
            box-shadow: 0 0 30px rgba(196, 76, 255, 0.4);
        }

        .status-bad {
            background: linear-gradient(135deg, #ff4444 0%, #cc0000 100%);
            color: white;
            box-shadow: 0 0 30px rgba(255, 68, 68, 0.5);
        }

        .milestones {
            margin-top: 2rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 1.5rem;
            position: relative;
            z-index: 1;
        }

        .milestones h3 {
            font-family: 'Fredoka One', cursive;
            color: var(--pink-light);
            margin-bottom: 1rem;
            font-size: 1.2rem;
        }

        .milestone-list {
            display: flex;
            flex-direction: column;
            gap: 0.8rem;
        }

        .milestone {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.8rem 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .milestone.achieved {
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.2) 0%, rgba(255, 170, 0, 0.1) 100%);
            border: 1px solid var(--gold);
        }

        .milestone-icon {
            font-size: 1.5rem;
            opacity: 0.5;
            transition: all 0.3s ease;
        }

        .milestone.achieved .milestone-icon {
            opacity: 1;
            animation: celebratePulse 1s ease infinite;
        }

        @keyframes celebratePulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .milestone-info {
            flex: 1;
        }

        .milestone-points {
            font-weight: 700;
            color: var(--gold);
        }

        .milestone-reward {
            font-size: 0.9rem;
            color: var(--pink-light);
        }

        .history-section {
            margin-top: 2rem;
            position: relative;
            z-index: 1;
        }

        .history-toggle {
            background: transparent;
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.6);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            width: 100%;
            transition: all 0.3s ease;
        }

        .history-toggle:hover {
            border-color: var(--pink);
            color: var(--pink);
        }

        .history-list {
            margin-top: 1rem;
            max-height: 200px;
            overflow-y: auto;
            display: none;
        }

        .history-list.show {
            display: block;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            font-size: 0.85rem;
        }

        .history-item.add {
            color: var(--gold);
        }

        .history-item.remove {
            color: var(--pink);
        }

        .rules-section {
            margin-top: 2rem;
            position: relative;
            z-index: 1;
        }

        .rules-toggle {
            background: transparent;
            border: 2px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.6);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            width: 100%;
            transition: all 0.3s ease;
        }

        .rules-toggle:hover {
            border-color: var(--gold);
            color: var(--gold);
        }

        .rules-content {
            margin-top: 1rem;
            display: none;
        }

        .rules-content.show {
            display: block;
        }

        .rules-category {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 12px;
            margin-bottom: 1rem;
            overflow: hidden;
        }

        .rules-category h4 {
            font-family: 'Fredoka One', cursive;
            padding: 1rem;
            margin: 0;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s ease;
        }

        .rules-category h4:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .good-rules h4 {
            color: var(--gold);
        }

        .bad-rules h4 {
            color: var(--pink);
        }

        .bonus-rules h4 {
            color: var(--purple);
        }

        .toggle-icon {
            font-size: 0.8rem;
            transition: transform 0.3s ease;
        }

        .toggle-icon.collapsed {
            transform: rotate(-90deg);
        }

        .rules-list {
            padding: 0 1rem 1rem 1rem;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .rules-list.collapsed {
            display: none;
        }

        .rule-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0.6rem 0.8rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .rule-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .rule-item.earn .rule-points {
            background: linear-gradient(135deg, var(--gold) 0%, #ffaa00 100%);
            color: var(--dark);
        }

        .rule-item.lose .rule-points {
            background: linear-gradient(135deg, var(--pink) 0%, #ff4466 100%);
            color: white;
        }

        .rule-item.bonus .rule-points {
            background: linear-gradient(135deg, var(--purple) 0%, var(--pink) 100%);
            color: white;
        }

        .rule-points {
            font-family: 'Fredoka One', cursive;
            font-size: 0.9rem;
            padding: 0.3rem 0.6rem;
            border-radius: 20px;
            min-width: 45px;
            text-align: center;
        }

        .rule-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
        }

        .rule-name {
            font-weight: 600;
            color: var(--cream);
            font-size: 0.95rem;
        }

        .rule-note {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.5);
            font-style: italic;
        }

        .music-player {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .music-btn {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--pink);
            color: var(--pink);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .music-btn:hover {
            background: var(--pink);
            color: var(--dark);
        }

        .music-btn.playing {
            background: var(--pink);
            color: var(--dark);
            animation: pulse 1.5s ease infinite;
        }

        @keyframes pulse {
            0%, 100% { box-shadow: 0 0 10px rgba(255, 107, 157, 0.5); }
            50% { box-shadow: 0 0 20px rgba(255, 107, 157, 0.8); }
        }

        .music-icon {
            font-size: 1rem;
        }

        .now-playing {
            font-size: 0.7rem;
            color: var(--pink-light);
            opacity: 0;
            transition: opacity 0.3s ease;
            white-space: nowrap;
        }

        .now-playing.show {
            opacity: 1;
        }

        .floating-stars {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            overflow: hidden;
            z-index: 0;
        }

        .floating-star {
            position: absolute;
            font-size: 1.5rem;
            opacity: 0.15;
            animation: float 15s linear infinite;
        }

        @keyframes float {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 0.15;
            }
            90% {
                opacity: 0.15;
            }
            100% {
                transform: translateY(-100px) rotate(720deg);
                opacity: 0;
            }
        }

        .celebration {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 4rem;
            z-index: 100;
            animation: celebrate 1s ease forwards;
            pointer-events: none;
        }

        @keyframes celebrate {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(0);
            }
            50% {
                transform: translate(-50%, -50%) scale(1.5);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -50%) scale(2);
            }
        }

        /* Modal styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal {
            background: linear-gradient(145deg, #3d2a54 0%, #2a1d3a 100%);
            border-radius: 20px;
            padding: 2rem;
            max-width: 400px;
            width: 90%;
            border: 3px solid var(--purple-dark);
        }

        .modal h2 {
            font-family: 'Fredoka One', cursive;
            color: var(--pink);
            margin-bottom: 1rem;
        }

        .modal p {
            margin-bottom: 1rem;
            color: var(--pink-light);
            font-size: 0.9rem;
        }

        .modal input {
            width: 100%;
            padding: 0.8rem;
            border-radius: 10px;
            border: 2px solid var(--purple);
            background: rgba(0, 0, 0, 0.3);
            color: var(--cream);
            font-size: 1rem;
            margin-bottom: 1rem;
        }

        .modal input:focus {
            outline: none;
            border-color: var(--pink);
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .modal-btn {
            padding: 0.6rem 1.2rem;
            border-radius: 20px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .modal-btn.save {
            background: var(--pink);
            color: white;
        }

        .modal-btn.cancel {
            background: transparent;
            border: 2px solid rgba(255, 255, 255, 0.3);
            color: rgba(255, 255, 255, 0.6);
        }

        .mode-switcher {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
        }

        .mode-switcher button {
            background: rgba(0, 0, 0, 0.5);
            border: 2px solid var(--purple);
            color: var(--pink-light);
            padding: 0.5rem 1rem;
            border-radius: 20px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: all 0.3s ease;
        }

        .mode-switcher button:hover {
            background: var(--purple);
            color: white;
        }

        .loading {
            text-align: center;
            padding: 3rem;
            color: var(--pink-light);
        }

        .loading-spinner {
            font-size: 3rem;
            animation: spin 1s linear infinite;
            display: inline-block;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .error-message {
            background: rgba(255, 68, 68, 0.2);
            border: 2px solid #ff4444;
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 1rem;
            color: #ff6b6b;
            text-align: center;
        }

        .setup-section {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .setup-section h3 {
            color: var(--gold);
            margin-bottom: 1rem;
        }

        .setup-section code {
            background: rgba(0, 0, 0, 0.3);
            padding: 0.2rem 0.5rem;
            border-radius: 5px;
            font-size: 0.85rem;
        }

        .setup-section ol {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .setup-section li {
            margin-bottom: 0.5rem;
        }

        @media (max-width: 600px) {
            h1 {
                font-size: 2rem;
            }

            .score-number {
                font-size: 3.5rem;
            }

            .btn {
                padding: 0.8rem 1.5rem;
                font-size: 1rem;
            }

            .container {
                padding: 1rem;
            }
        }
    </style>
</head>
<body>
    <div class="floating-stars" id="floatingStars"></div>

    <div class="container">
        <header>
            <h1>‚ú® The Good Noodle Board ‚ú®</h1>
            <p class="subtitle">Be good... or don't üòà</p>
            <div class="mode-badge" id="modeBadge">Loading...</div>
        </header>

        <!-- Setup Instructions (shown if Firebase not configured) -->
        <div class="setup-section" id="setupSection" style="display: none;">
            <h3>üîß Firebase Setup Required</h3>
            <p>To use this board, you need to set up Firebase:</p>
            <ol>
                <li>Go to <a href="https://console.firebase.google.com" target="_blank" style="color: var(--pink);">Firebase Console</a></li>
                <li>Create a new project (or use existing)</li>
                <li>Go to Project Settings ‚Üí Add Web App</li>
                <li>Copy your config and paste it in the <code>firebaseConfig</code> section of this file</li>
                <li>Go to Realtime Database ‚Üí Create Database (start in test mode)</li>
                <li>Set your DOM_PASSWORD in the code</li>
            </ol>
            <p style="color: var(--gold);">Once configured, refresh the page!</p>
        </div>

        <div id="mainContent" style="display: none;">
            <div class="noodle-name-section">
                <span class="noodle-name" id="noodleName">Little Brat</span>
                <button class="edit-name-btn" id="editNameBtn" onclick="openNameModal()">‚úèÔ∏è Edit</button>
            </div>

            <div class="board">
                <div class="score-display">
                    <div class="score-label">Current Stars</div>
                    <div class="score-number" id="score">0</div>
                </div>

                <div class="star-grid" id="starGrid"></div>

                <div class="controls" id="domControls">
                    <button class="btn btn-add" onclick="addStar()">
                        ‚≠ê Good Noodle!
                    </button>
                    <button class="btn btn-remove" onclick="removeStar()">
                        üíî Bad Noodle...
                    </button>
                </div>

                <div class="status-section">
                    <div class="status-badge status-neutral" id="statusBadge">
                        Starting Fresh~
                    </div>
                </div>

                <div class="milestones">
                    <h3 id="milestoneTitle">üéØ Good Noodle Rewards</h3>
                    <div class="milestone-list" id="milestoneList"></div>
                </div>

                <div class="history-section">
                    <button class="history-toggle" onclick="toggleHistory()">
                        üìú View History
                    </button>
                    <div class="history-list" id="historyList"></div>
                </div>

                <div class="rules-section">
                    <button class="rules-toggle" onclick="toggleRules()">
                        üìã View Rules
                    </button>
                    <div class="rules-content" id="rulesContent">
                        <div class="rules-category good-rules">
                            <h4 onclick="toggleRuleCategory('goodRules')">‚≠ê Earning Stars <span class="toggle-icon" id="goodRulesIcon">‚ñº</span></h4>
                            <div class="rules-list" id="goodRules">
                                <div class="rule-item earn">
                                    <span class="rule-points">+1</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Following instructions without bratting</span>
                                        <span class="rule-note">First time, no pushback</span>
                                    </div>
                                </div>
                                <div class="rule-item earn">
                                    <span class="rule-points">+1</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Completing tasks/chores</span>
                                        <span class="rule-note">Dishes, tidying, errands</span>
                                    </div>
                                </div>
                                <div class="rule-item earn">
                                    <span class="rule-points">+1</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Using manners unprompted</span>
                                        <span class="rule-note">"Please", "Thank you", "Sir"</span>
                                    </div>
                                </div>
                                <div class="rule-item earn">
                                    <span class="rule-points">+1</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Being patient</span>
                                        <span class="rule-note">No whining or pestering</span>
                                    </div>
                                </div>
                                <div class="rule-item earn">
                                    <span class="rule-points">+1</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Sending good morning/goodnight texts</span>
                                        <span class="rule-note">Consistency matters</span>
                                    </div>
                                </div>
                                <div class="rule-item earn">
                                    <span class="rule-points">+2</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Surprise acts of service</span>
                                        <span class="rule-note">Making tea, back rubs, etc.</span>
                                    </div>
                                </div>
                                <div class="rule-item earn">
                                    <span class="rule-points">+2</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Admitting when wrong</span>
                                        <span class="rule-note">Without being defensive</span>
                                    </div>
                                </div>
                                <div class="rule-item earn">
                                    <span class="rule-points">+2</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Going above and beyond</span>
                                        <span class="rule-note">Extra effort on something</span>
                                    </div>
                                </div>
                                <div class="rule-item earn">
                                    <span class="rule-points">+3</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Being brave</span>
                                        <span class="rule-note">Trying something new/hard, facing fears</span>
                                    </div>
                                </div>
                                <div class="rule-item earn">
                                    <span class="rule-points">+5</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Full day of perfect behavior</span>
                                        <span class="rule-note">No warnings needed</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="rules-category bad-rules">
                            <h4 onclick="toggleRuleCategory('badRules')">üíî Losing Stars <span class="toggle-icon" id="badRulesIcon">‚ñº</span></h4>
                            <div class="rules-list" id="badRules">
                                <div class="rule-item lose">
                                    <span class="rule-points">-1</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Eye rolling</span>
                                        <span class="rule-note">Attitude check</span>
                                    </div>
                                </div>
                                <div class="rule-item lose">
                                    <span class="rule-points">-1</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Whining/pouting</span>
                                        <span class="rule-note">Use your words properly</span>
                                    </div>
                                </div>
                                <div class="rule-item lose">
                                    <span class="rule-points">-1</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Talking back</span>
                                        <span class="rule-note">Sass without permission</span>
                                    </div>
                                </div>
                                <div class="rule-item lose">
                                    <span class="rule-points">-1</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Forgetting manners</span>
                                        <span class="rule-note">No "please" or "thank you"</span>
                                    </div>
                                </div>
                                <div class="rule-item lose">
                                    <span class="rule-points">-2</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Ignoring messages</span>
                                        <span class="rule-note">Within reasonable time</span>
                                    </div>
                                </div>
                                <div class="rule-item lose">
                                    <span class="rule-points">-2</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Lying (small)</span>
                                        <span class="rule-note">White lies, omissions</span>
                                    </div>
                                </div>
                                <div class="rule-item lose">
                                    <span class="rule-points">-2</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Breaking a rule</span>
                                        <span class="rule-note">Established boundaries</span>
                                    </div>
                                </div>
                                <div class="rule-item lose">
                                    <span class="rule-points">-3</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Tantrum/attitude blowup</span>
                                        <span class="rule-note">Full bratty meltdown</span>
                                    </div>
                                </div>
                                <div class="rule-item lose">
                                    <span class="rule-points">-5</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Lying (big)</span>
                                        <span class="rule-note">Trust issues</span>
                                    </div>
                                </div>
                                <div class="rule-item lose">
                                    <span class="rule-points">-5</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Deliberately disobeying</span>
                                        <span class="rule-note">Knew the rule, did it anyway</span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="rules-category bonus-rules">
                            <h4 onclick="toggleRuleCategory('bonusRules')">üéØ Bonus Modifiers <span class="toggle-icon" id="bonusRulesIcon">‚ñº</span></h4>
                            <div class="rules-list" id="bonusRules">
                                <div class="rule-item bonus">
                                    <span class="rule-points">√ó2</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Repeat offense same day</span>
                                        <span class="rule-note">Double the penalty</span>
                                    </div>
                                </div>
                                <div class="rule-item bonus">
                                    <span class="rule-points">-1</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Unprompted confession</span>
                                        <span class="rule-note">Reduce penalty by 1</span>
                                    </div>
                                </div>
                                <div class="rule-item bonus">
                                    <span class="rule-points">+2</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Consistency streak (3+ days good)</span>
                                        <span class="rule-note">Bonus for being good</span>
                                    </div>
                                </div>
                                <div class="rule-item bonus">
                                    <span class="rule-points">+3</span>
                                    <div class="rule-info">
                                        <span class="rule-name">Weekly review: mostly good</span>
                                        <span class="rule-note">End of week bonus</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="controls" id="resetControls" style="margin-top: 1.5rem;">
                    <button class="btn btn-reset" onclick="resetBoard()">
                        üîÑ Reset Board
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Mode Switcher -->
    <div class="mode-switcher">
        <button onclick="openModeModal()" id="modeSwitchBtn">üîê Switch Mode</button>
    </div>

    <!-- Music Player -->
    <div class="music-player">
        <button class="music-btn" id="musicBtn" onclick="toggleMusic()">
            <span class="music-icon" id="musicIcon">‚ñ∂Ô∏è</span>
            <span>Music</span>
        </button>
        <span class="now-playing" id="nowPlaying">‚ô™ Cupid - FIFTY FIFTY</span>
    </div>

    <!-- Audio Element -->
    <audio id="bgMusic" loop>
        <source src="cupid.mp3" type="audio/mpeg">
    </audio>

    <!-- Name Edit Modal -->
    <div class="modal-overlay" id="nameModal">
        <div class="modal">
            <h2>Edit Noodle Name</h2>
            <input type="text" id="nameInput" placeholder="Enter name..." maxlength="20">
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeNameModal()">Cancel</button>
                <button class="modal-btn save" onclick="saveName()">Save</button>
            </div>
        </div>
    </div>

    <!-- Mode Switch Modal -->
    <div class="modal-overlay" id="modeModal">
        <div class="modal">
            <h2>üîê Switch Mode</h2>
            <p>Enter the Dom password to unlock controls, or leave blank for Brat view.</p>
            <input type="password" id="passwordInput" placeholder="Enter password...">
            <div class="modal-buttons">
                <button class="modal-btn cancel" onclick="closeModeModal()">Cancel</button>
                <button class="modal-btn save" onclick="checkPassword()">Enter</button>
            </div>
        </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <script>
        // ============================================
        // üîß CONFIGURATION - EDIT THESE VALUES
        // ============================================
        
        // Your Firebase config (get this from Firebase Console)
        const firebaseConfig = {
            apiKey: "AIzaSyDyVuq2cB68FHnebsgQUe0DHguwh5TqQe8",
            authDomain: "good-noodle-board.firebaseapp.com",
            databaseURL: "https://good-noodle-board-default-rtdb.firebaseio.com",
            projectId: "good-noodle-board",
            storageBucket: "good-noodle-board.firebasestorage.app",
            messagingSenderId: "212861087145",
            appId: "1:212861087145:web:59a1f0cd497295742a28b8"
        };

        // Set your Dom password here (change this!)
        const DOM_PASSWORD = "GoodGirl2025";

        // ============================================
        // END CONFIGURATION
        // ============================================

        // Milestones
        const goodMilestones = [
            { points: 5, reward: "Head pats & 'Good girl' praise session", icon: "ü•∞" },
            { points: 10, reward: "Pick the movie/show tonight", icon: "üé¨" },
            { points: 15, reward: "Special treat of choice", icon: "üç∞" },
            { points: 20, reward: "Pamper session & breakfast in bed", icon: "üõÅ" },
            { points: 25, reward: "Date night of your choice", icon: "üíï" },
            { points: 30, reward: "One free 'get out of trouble' card", icon: "üëº" },
        ];

        const badMilestones = [
            { points: -3, reward: "Must use manners (Sir/please/thank you)", icon: "üôä" },
            { points: -5, reward: "Edge but no finish", icon: "üî•" },
            { points: -8, reward: "Has to ask permission for treats", icon: "üç¨" },
            { points: -10, reward: "No touching without permission", icon: "üö´" },
            { points: -15, reward: "Wear something of Dom's choosing", icon: "üëó" },
            { points: -20, reward: "Write an apology letter", icon: "üìù" },
            { points: -25, reward: "No dessert for a week", icon: "üò¢" },
        ];

        // State
        let isDomMode = false;
        let db = null;
        let dataRef = null;
        let state = {
            score: 0,
            name: "Little Brat",
            history: []
        };

        // Check if Firebase is configured
        function isFirebaseConfigured() {
            return firebaseConfig.apiKey !== "YOUR_API_KEY" && 
                   firebaseConfig.projectId !== "YOUR_PROJECT";
        }

        // Initialize Firebase
        function initFirebase() {
            if (!isFirebaseConfigured()) {
                document.getElementById('setupSection').style.display = 'block';
                document.getElementById('modeBadge').textContent = '‚ö†Ô∏è Setup Required';
                return false;
            }

            try {
                firebase.initializeApp(firebaseConfig);
                db = firebase.database();
                dataRef = db.ref('goodNoodleBoard');
                
                // Listen for real-time updates
                dataRef.on('value', (snapshot) => {
                    const data = snapshot.val();
                    if (data) {
                        state = { ...state, ...data };
                    }
                    render();
                });

                document.getElementById('mainContent').style.display = 'block';
                
                // Check for saved mode
                const savedMode = localStorage.getItem('noodleBoardMode');
                if (savedMode === 'dom') {
                    isDomMode = true;
                }
                updateModeUI();
                
                return true;
            } catch (error) {
                console.error('Firebase init error:', error);
                document.getElementById('setupSection').style.display = 'block';
                document.getElementById('modeBadge').textContent = '‚ùå Firebase Error';
                return false;
            }
        }

        // Save state to Firebase
        function saveState() {
            if (dataRef) {
                dataRef.set(state);
            }
        }

        // Update UI based on mode
        function updateModeUI() {
            const badge = document.getElementById('modeBadge');
            const domControls = document.getElementById('domControls');
            const resetControls = document.getElementById('resetControls');
            const editNameBtn = document.getElementById('editNameBtn');
            
            if (isDomMode) {
                badge.className = 'mode-badge dom';
                badge.textContent = 'üëë Dom Mode';
                domControls.classList.remove('hidden');
                resetControls.style.display = 'flex';
                editNameBtn.style.display = 'inline-block';
            } else {
                badge.className = 'mode-badge brat';
                badge.textContent = 'üéÄ Brat View';
                domControls.classList.add('hidden');
                resetControls.style.display = 'none';
                editNameBtn.style.display = 'none';
            }
        }

        // Render everything
        function render() {
            renderScore();
            renderStars();
            renderStatus();
            renderMilestones();
            renderHistory();
            renderName();
        }

        function renderName() {
            document.getElementById('noodleName').textContent = state.name;
        }

        function renderScore() {
            const scoreEl = document.getElementById('score');
            scoreEl.textContent = state.score;
            scoreEl.classList.add('bounce');
            setTimeout(() => scoreEl.classList.remove('bounce'), 500);
        }

        function renderStars() {
            const grid = document.getElementById('starGrid');
            grid.innerHTML = '';
            
            const starCount = Math.abs(state.score);
            const isPositive = state.score >= 0;
            
            for (let i = 0; i < starCount; i++) {
                const star = document.createElement('span');
                star.className = 'star';
                star.textContent = isPositive ? '‚≠ê' : 'üíî';
                star.style.animationDelay = `${i * 0.05}s`;
                grid.appendChild(star);
            }
        }

        function renderStatus() {
            const badge = document.getElementById('statusBadge');
            const score = state.score;
            
            if (score >= 15) {
                badge.className = 'status-badge status-good';
                badge.textContent = 'üåü Perfect Angel! üåü';
            } else if (score >= 10) {
                badge.className = 'status-badge status-good';
                badge.textContent = '‚ú® Such a Good Noodle! ‚ú®';
            } else if (score >= 5) {
                badge.className = 'status-badge status-neutral';
                badge.textContent = 'üòä Doing Well~';
            } else if (score > 0) {
                badge.className = 'status-badge status-neutral';
                badge.textContent = 'üôÇ Keep it up!';
            } else if (score === 0) {
                badge.className = 'status-badge status-neutral';
                badge.textContent = 'üò∂ Starting Fresh~';
            } else if (score > -5) {
                badge.className = 'status-badge status-neutral';
                badge.textContent = 'üò≥ Someone\'s being bratty...';
            } else if (score > -10) {
                badge.className = 'status-badge status-bad';
                badge.textContent = 'üòà Naughty Noodle!';
            } else {
                badge.className = 'status-badge status-bad';
                badge.textContent = 'üî• Maximum Brat Mode üî•';
            }
        }

        function renderMilestones() {
            const list = document.getElementById('milestoneList');
            const title = document.getElementById('milestoneTitle');
            list.innerHTML = '';
            
            let milestonesToShow = [];
            
            if (state.score >= 0) {
                title.textContent = 'üéØ Good Noodle Rewards';
                title.style.color = 'var(--gold)';
                milestonesToShow = goodMilestones.sort((a, b) => a.points - b.points);
            } else {
                title.textContent = 'üòà Naughty Noodle Consequences';
                title.style.color = 'var(--pink)';
                milestonesToShow = badMilestones.sort((a, b) => b.points - a.points);
            }
            
            milestonesToShow.forEach(m => {
                const achieved = (m.points > 0 && state.score >= m.points) || 
                               (m.points < 0 && state.score <= m.points);
                
                const div = document.createElement('div');
                div.className = `milestone ${achieved ? 'achieved' : ''}`;
                div.innerHTML = `
                    <span class="milestone-icon">${m.icon}</span>
                    <div class="milestone-info">
                        <span class="milestone-points">${m.points > 0 ? '+' : ''}${m.points} stars</span>
                        <div class="milestone-reward">${m.reward}</div>
                    </div>
                `;
                list.appendChild(div);
            });
        }

        function renderHistory() {
            const list = document.getElementById('historyList');
            list.innerHTML = '';
            
            if (!state.history) state.history = [];
            
            const recent = state.history.slice(-20).reverse();
            recent.forEach(item => {
                const div = document.createElement('div');
                div.className = `history-item ${item.type}`;
                div.innerHTML = `
                    <span>${item.type === 'add' ? '‚≠ê +1' : 'üíî -1'} ${item.reason || ''}</span>
                    <span>${new Date(item.time).toLocaleString()}</span>
                `;
                list.appendChild(div);
            });
        }

        function addStar() {
            if (!isDomMode) return;
            
            state.score++;
            if (!state.history) state.history = [];
            state.history.push({
                type: 'add',
                time: Date.now(),
                reason: ''
            });
            saveState();
            
            const milestone = goodMilestones.find(m => state.score === m.points);
            if (milestone) {
                celebrate(milestone.icon);
            }
        }

        function removeStar() {
            if (!isDomMode) return;
            
            state.score--;
            if (!state.history) state.history = [];
            state.history.push({
                type: 'remove',
                time: Date.now(),
                reason: ''
            });
            saveState();
            
            const milestone = badMilestones.find(m => state.score === m.points);
            if (milestone) {
                celebrate(milestone.icon);
            }
        }

        function celebrate(emoji) {
            const el = document.createElement('div');
            el.className = 'celebration';
            el.textContent = emoji;
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 1000);
        }

        function toggleHistory() {
            const list = document.getElementById('historyList');
            list.classList.toggle('show');
        }

        function toggleRules() {
            const content = document.getElementById('rulesContent');
            content.classList.toggle('show');
        }

        function toggleRuleCategory(categoryId) {
            const list = document.getElementById(categoryId);
            const icon = document.getElementById(categoryId + 'Icon');
            list.classList.toggle('collapsed');
            icon.classList.toggle('collapsed');
        }

        // Music Player
        let isPlaying = false;
        const bgMusic = document.getElementById('bgMusic');
        const musicBtn = document.getElementById('musicBtn');
        const musicIcon = document.getElementById('musicIcon');
        const nowPlaying = document.getElementById('nowPlaying');

        function toggleMusic() {
            if (isPlaying) {
                bgMusic.pause();
                musicIcon.textContent = '‚ñ∂Ô∏è';
                musicBtn.classList.remove('playing');
                nowPlaying.classList.remove('show');
            } else {
                bgMusic.play();
                musicIcon.textContent = '‚è∏Ô∏è';
                musicBtn.classList.add('playing');
                nowPlaying.classList.add('show');
            }
            isPlaying = !isPlaying;
        }

        // Reset button state if music ends (though it loops)
        bgMusic.addEventListener('ended', () => {
            musicIcon.textContent = '‚ñ∂Ô∏è';
            musicBtn.classList.remove('playing');
            nowPlaying.classList.remove('show');
            isPlaying = false;
        });

        function resetBoard() {
            if (!isDomMode) return;
            
            if (confirm('Are you sure you want to reset the board? This cannot be undone!')) {
                state.score = 0;
                state.history = [];
                saveState();
            }
        }

        // Name Modal
        function openNameModal() {
            if (!isDomMode) return;
            document.getElementById('nameModal').classList.add('show');
            document.getElementById('nameInput').value = state.name;
            document.getElementById('nameInput').focus();
        }

        function closeNameModal() {
            document.getElementById('nameModal').classList.remove('show');
        }

        function saveName() {
            const name = document.getElementById('nameInput').value.trim();
            if (name) {
                state.name = name;
                saveState();
            }
            closeNameModal();
        }

        // Mode Modal
        function openModeModal() {
            document.getElementById('modeModal').classList.add('show');
            document.getElementById('passwordInput').value = '';
            document.getElementById('passwordInput').focus();
        }

        function closeModeModal() {
            document.getElementById('modeModal').classList.remove('show');
        }

        function checkPassword() {
            const password = document.getElementById('passwordInput').value;
            
            if (password === DOM_PASSWORD) {
                isDomMode = true;
                localStorage.setItem('noodleBoardMode', 'dom');
            } else {
                isDomMode = false;
                localStorage.setItem('noodleBoardMode', 'brat');
            }
            
            updateModeUI();
            closeModeModal();
        }

        // Event listeners
        document.getElementById('nameInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') saveName();
        });

        document.getElementById('passwordInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') checkPassword();
        });

        document.getElementById('nameModal').addEventListener('click', (e) => {
            if (e.target.id === 'nameModal') closeNameModal();
        });

        document.getElementById('modeModal').addEventListener('click', (e) => {
            if (e.target.id === 'modeModal') closeModeModal();
        });

        // Create floating background stars
        function createFloatingStars() {
            const container = document.getElementById('floatingStars');
            const stars = ['‚≠ê', '‚ú®', 'üí´', 'üåü', 'üíï'];
            
            for (let i = 0; i < 15; i++) {
                const star = document.createElement('div');
                star.className = 'floating-star';
                star.textContent = stars[Math.floor(Math.random() * stars.length)];
                star.style.left = `${Math.random() * 100}%`;
                star.style.animationDuration = `${15 + Math.random() * 10}s`;
                star.style.animationDelay = `${Math.random() * 15}s`;
                container.appendChild(star);
            }
        }

        // Initialize
        createFloatingStars();
        initFirebase();
    </script>
</body>
</html>
